resource "azurerm_policy_set_definition" "anti_malware" {

  name         = "anti_malware"
  policy_type  = "Custom"
  display_name = "Anti Malware"
  description  = "Contains common Anti Malware policies"

  metadata = jsonencode(
    {
      "category" : "${var.policyset_definition_category}"
    }

  )

  dynamic "policy_definition_reference" {
    for_each = data.azurerm_policy_definition.builtin_policies_anti_malware
    content {
      policy_definition_id = policy_definition_reference.value["id"]
      reference_id         = policy_definition_reference.value["display_name"]
    }
  }
}
